---
title: TurtleBot4 Basic Setup
description: "TurtleBot4 Basic Setup"
---

## Basic Command 

Run

```bash Run Robot
uv run src/run.py turtlebot4
```

OM1 connects to TurtleBot4 using Zenoh. To correctly set up your TurtleBot4, follow these steps.

## Set Up

1. Set up your TurtleBot4 following the [Basic Setup](https://turtlebot.github.io/turtlebot4-user-manual/setup/basic.html). These instructions are for `turtlebot4_standard_humble_1.0.4.img`, but should work for any current TurtleBot4 image. Please spend some time to become familiar with the Turtlebot4 ecosystem - there are extensive educational materials to help you get started. NOTE: we now assume you are generally familiar with the ROS2/Turtlebot4 system.

2. As you have just experienced first-hand, there are numerous issues connecting to a TurtleBot4 in a university/enterprise network. To solve many of those, we follow the dual Zenoh bridge approach developed by [theconstruct.ai](www.theconstruct.ai), which is to give the Raspberry Pi and the Create3 their own ROS2 DOMAIN_IDs, and then use Zenoh bridges to control message traffic between the RPi and the Create3. Follow their [instructions here](https://hub.docker.com/r/theconstructai/zenoh-bridge-ros2dds). This allows you to filter message traffic on a per topic level (see the `config_create3.json5` file for an example of how this is done).

Make the following `ROS_DOMAIN_ID` changes to the Turtlebot4. Use the `turtlebot4-setup` tool to access `ROS Setup:Bash Setup` and set it to the following:

```bash
ROBOT_NAMESPACE=/pi
ROS_DOMAIN_ID=0
RMW_IMPLEMENTATION=rmw_cyclonedds_cpp
CYCLONEDDS_URI=[] # Empty
```

Click "Save", "Esc", and then "Apply Settings". Then, access the Create3's App config page at its web server (e.g. `192.168.1.193:8080/ros-config`). Change the ROS_DOMAIN_ID to 1. Click `Save` and _Restart Application_.

Finally, on the TurtleBot4's RPi, [install Docker](https://docs.docker.com/engine/install/raspberry-pi-os/) and run `sudo docker compose -f docker-compose.yaml up -d`. The `docker-compose` should be:

```bash docker-compose.yaml
services:
  zenoh-bridge-turtlebot4:
    image: openmindagi/turtlebridge
    container_name: zenoh-bridge-turtlebot4
    network_mode: "host"
    restart: always # Ensures the container restarts on reboot
```

The TurtleBot4 will now be more stable, can now discover other computers running Zenoh, send them Zenoh messages, and also, accept Zenoh messages and forward them to ROS2.

3. On the TurtleBot4 command line, test the system:

```bash
ros2 topic list
ros2 action list
ros2 topic echo /pi/scan
```

To spin the robot, on the TurtleBot4 command line issue:

```bash
ros2 topic pub /cmd_vel geometry_msgs/msg/Twist "linear:
  x: 0.0
  y: 0.0
  z: 0.0
angular:
  x: 0.0
  y: 0.0
  z: 0.1"
```

To debug movement, use `ros2 topic info /pi/cmd_vel --verbose`.

4. Install Zenoh on your Mac, PC, or Linux computer, following [Installing the Zenoh router](https://zenoh.io/docs/getting-started/installation/)

Please make sure the your laptop is running the same version of the bridge (e.g. 1.2.1) as the Raspberry Pi otherwise you will get errors.

Add the optional Python CycloneDDS module to OM1:

```bash
uv pip install -r pyproject.toml --extra dds
```

Congratulations! You can now interact with a TurtleBot4 from your Mac laptop, using OM1 and Zenoh.

## Accessing TurtleBot4 Data on a Remote Computer using Zenoh

Read TurtleBot4 laser scan and battery data:
```bash
uv run system_hw_test/turtlebot4_laserscan.py
```

## Expected ROS2 Topics for a correctly configured system

On the TurtleBot4 command line, run `ros2 topic list`. Topics with a `pi` prefix originate from the Raspberry Pi, and topics without a prefix are from the Create3.

```bash
# Create3
/battery_state
/cmd_vel
/diagnostics
/dock_status
/imu
/odom
/parameter_events
/robot_state/transition_event
/rosout
/static_transform/transition_event
/tf
/tf_static

# RPi
/pi/battery_state
/pi/cmd_vel
/pi/diagnostics
/pi/diagnostics_agg
/pi/diagnostics_toplevel_state
/pi/dock_status
/pi/function_calls
/pi/hazard_detection
/pi/hmi/buttons
/pi/hmi/display
/pi/hmi/display/message
/pi/hmi/led
/pi/imu
/pi/interface_buttons
/pi/ip
/pi/joint_states
/pi/joy
/pi/joy/set_feedback
/pi/mouse
/pi/oakd/rgb/preview/camera_info
/pi/oakd/rgb/preview/image_raw
/pi/robot_description
/pi/scan
/pi/tf
/pi/tf_static
/pi/wheel_status
```

## Building the Docker Dual Bridge Images

You can also build your own dual bridge docker images:

```bash
docker build -t my-username/my-image .
docker push my-username/my-image
```

Useful docker commands
```bash
sudo docker compose pull # pull latest image

# Images
sudo docker images
sudo docker rmi IMAGE_ID --force

# Containers
sudo docker ps -a
sudo docker attach CONTAINER_ID # to stream logs
sudo docker exec -it CONTAINER_ID sh # to get a shell
sudo docker kill CONTAINER_ID
```